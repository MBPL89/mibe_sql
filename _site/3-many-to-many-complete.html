<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Bartosiak">

<title>Many-to-Many relationship – MIBE SQL Corner</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/interactive-sql-1.0.0/interactive-sql.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://unpkg.com/@antonz/sqlite@3.40.0/dist/sqlite3.js"></script>
<script src="https://unpkg.com/sqlime@0.1.3/dist/sqlime-db.js"></script>
<script src="https://unpkg.com/sqlime@0.1.3/dist/sqlime-examples.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MIBE SQL Corner</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-class-materials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Class materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-class-materials">    
        <li>
    <a class="dropdown-item" href="./Introduction.html">
 <span class="dropdown-text">Database Management - Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1-single-entity.html">
 <span class="dropdown-text">Introduction to SQL. Single entity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2-one-to-many.html">
 <span class="dropdown-text">One-to-Many relationship</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3-many-to-many.html">
 <span class="dropdown-text">Many-to-Many relationship</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./4-server-conn.html">
 <span class="dropdown-text">Server Connections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./5-one-to-one-and-recursive.html">
 <span class="dropdown-text">One-to-One and Recursive relationship</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-class-materials---complete" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Class materials - complete</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-class-materials---complete">    
        <li>
    <a class="dropdown-item" href="./1-single-entity-complete.html">
 <span class="dropdown-text">Introduction to SQL. Single entity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2-one-to-many-complete.html">
 <span class="dropdown-text">One-to-Many relationship</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3-many-to-many-complete.html">
 <span class="dropdown-text">Many-to-Many relationship</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./4-server-conn.html">
 <span class="dropdown-text">Server Connections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./5-one-to-one-and-recursive-complete.html">
 <span class="dropdown-text">One-to-One and Recursive relationship</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Homeworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-homeworks">    
        <li>
    <a class="dropdown-item" href="./Homework1.html">
 <span class="dropdown-text">Homework 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Homework2.html">
 <span class="dropdown-text">Homework2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Homework3.html">
 <span class="dropdown-text">Homework3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Homework4.html">
 <span class="dropdown-text">Homework4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homework-solutions" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Homework solutions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-homework-solutions">    
        <li>
    <a class="dropdown-item" href="./Homework1-solution.html">
 <span class="dropdown-text">Homework 1 solution</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Homework2-solution.html">
 <span class="dropdown-text">Homework2 solution</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-challenges" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Challenges</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-challenges">    
        <li>
    <a class="dropdown-item" href="./4-server-challenge.html">
 <span class="dropdown-text">Server Connections - practice</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-readings" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Readings</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-readings">    
        <li>
    <a class="dropdown-item" href="./Readings.html">
 <span class="dropdown-text">Readings</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#database-modelling" id="toc-database-modelling" class="nav-link active" data-scroll-target="#database-modelling">Database Modelling</a>
  <ul class="collapse">
  <li><a href="#a-sales-form-example" id="toc-a-sales-form-example" class="nav-link" data-scroll-target="#a-sales-form-example">A sales form example</a></li>
  <li><a href="#implementing-many-to-many" id="toc-implementing-many-to-many" class="nav-link" data-scroll-target="#implementing-many-to-many">Implementing many-to-many</a></li>
  <li><a href="#database-manipulation" id="toc-database-manipulation" class="nav-link" data-scroll-target="#database-manipulation">Database Manipulation</a></li>
  <li><a href="#extra-practice-cell" id="toc-extra-practice-cell" class="nav-link" data-scroll-target="#extra-practice-cell">Extra practice cell</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Many-to-Many relationship</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Bartosiak </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="database-modelling" class="level1">
<h1>Database Modelling</h1>
<p>One-to-many relationship will not always be enough to represent all the situations in real life.</p>
<section id="a-sales-form-example" class="level2">
<h2 class="anchored" data-anchor-id="a-sales-form-example">A sales form example</h2>
<p>A sales form is a document or (digital) record that captures details of a sale, including the products sold, the quantities, the price, the date, and the customer information.</p>
<p><a href="images/salesform.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/salesform.png" class="img-fluid" width="550"></a></p>
<p>If you think about it, it would be hard to design a one-to-many relationship for a sales form:</p>
<ul>
<li><p>You can sell (conceptually) the same item many times. (E.g. Yesterday you sold two IPhones. Today you also sold an IPhone.)</p></li>
<li><p>In one sale, you can sell various products. (E.g. A client bought an Iphone and an IPad.)</p></li>
</ul>
<p>To represent this situation in database modeling, we would need a <strong>many-to-many relationship</strong> between sales and products. This is because a single sale can include multiple products, and the same product can be sold in multiple sales. To model this relationship, a junction table (often called sales_details or order_items) is used, linking the sales table (which stores each transaction) with the products table. This table typically includes fields such as sale_id, product_id, quantity, and price. The many-to-many nature of this relationship allows for flexibility in tracking sales history and inventory management.</p>
</section>
<section id="implementing-many-to-many" class="level2">
<h2 class="anchored" data-anchor-id="implementing-many-to-many">Implementing many-to-many</h2>
<p>In a <strong>many-to-many (m:m) relationship</strong>, a <strong>third entity</strong> is required to properly map the connection between the two related entities. This third entity, known as an <strong>associative entity</strong>, acts as a bridge between them.</p>
<p><a href="images/salesformmodel.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/salesformmodel.png" class="img-fluid" width="550"></a></p>
<p>In database modeling, the <strong>associative table</strong> includes two <strong>foreign keys</strong>, one for each of the entities in the m:m relationship, ensuring that each instance of the relationship is properly recorded. Additionally, a foreign key can also be part of the <strong>primary key</strong> of the associative entity.</p>
<p><a href="images/salesformtable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/salesformtable.png" class="img-fluid" width="550"></a></p>
<p>For example, in a sales database, a <code>LINEITEM</code> table is used to associate <code>SALE</code> and <code>PRODUCT</code>. The <code>LINEITEM</code> table is identified by concatenating <code>lineno</code> and <code>saleno</code>, as indicated by the <strong>+ on the crow’s foot notation</strong>. This structure ensures data integrity and enforces the same relational rules as any other table in the database.</p>
<p>As you already know the concepts related to the implementable model, let’s take a look at many-to-many model:</p>
<p><a href="images/implsalesform.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/implsalesform.png" class="img-fluid" width="550"></a></p>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<p>Let’s go back to our hotel database. So far it was a fairly simple database. However, its’ main purpose is not to track hotels. It stores data about hotel reviews, scraped from the Internet.</p>
<p><a href="images/hotelreview.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/hotelreview.png" class="img-fluid" width="750"></a></p>
<p><strong>How would you model the following scenario?</strong> - An author can write reviews about many hotels. - A hotel can have reviews written by many authors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/reviewmodel.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="550"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="database-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="database-manipulation">Database Manipulation</h2>
<p>So far, we’ve learned how to join tables using the <code>WHERE</code> clause—this is known as an implicit join.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Implicit JOIN (OR “Comma syntax” JOIN)</em></p>
<p><code>SELECT ... FROM ..., ... WHERE fk = pk;</code></p>
<p><code>SELECT * FROM table1, table2 WHERE table1.id = table2.id;</code></p>
</div>
</div>
<p>While implicit joins work, SQL also provides a more structured way to combine tables: explicit joins using keywords like <code>JOIN ... ON</code>.</p>
<p>The key difference is that implicit joins mix filtering (<code>WHERE</code>) with table relationships, making queries harder to read as they grow. Explicit joins, on the other hand, separate the logic of joining tables from filtering rows, improving readability and maintainability.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Explicit JOIN</em></p>
<p><code>SELECT ... FROM ... JOIN ... ON fk = pk;</code></p>
<p><code>SELECT * FROM table1 JOIN table2 ON table1.id = table2.id;</code></p>
</div>
</div>
<p>Different join syntaxes exist because SQL is designed to be flexible. In some cases, explicit joins provide better performance and clarity, especially when dealing with complex queries or different types of joins (we will see them later).</p>
<p>There many ways to JOIN tbles in SQL. All these methods are called Equijoin.</p>
<p>Compare These queries:</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb1"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> brand, lodgingchain <span class="kw">WHERE</span> brand.chainId <span class="op">=</span> lodgingchain.chainId;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="interactive-sql">
<div class="sourceCode" id="cb2"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> brand <span class="kw">JOIN</span> lodgingchain <span class="kw">ON</span> brand.chainId <span class="op">=</span> lodgingchain.chainId;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="interactive-sql">
<div class="sourceCode" id="cb3"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> brand <span class="kw">NATURAL</span> <span class="kw">JOIN</span> lodgingchain;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="interactive-sql">
<div class="sourceCode" id="cb4"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> brand <span class="kw">JOIN</span> lodgingchain <span class="kw">USING</span>(chainId);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="three-table-join" class="level3">
<h3 class="anchored" data-anchor-id="three-table-join">Three table join</h3>
<p>List the authors that have reviewed hotels. Report the author name, the hotel ID and the name of the hotels. Order the output by author name.</p>
<p>Use all four methods</p>
<p>implicit JOIN (WHERE)</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb5"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> authorNickname, hotel.hotelId, hotelName</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> author, review, hotel</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> review.authorId <span class="op">=</span> author.authorId</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">AND</span> review.hotelId <span class="op">=</span> hotel.hotelId</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> authorNickname;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NATURAL JOIN</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb6"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> authorNickname, hotelId, hotelName </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> author </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">NATURAL</span> <span class="kw">JOIN</span> review </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">NATURAL</span> <span class="kw">JOIN</span> hotel </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> authorNickname;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>JOIN … USING</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb7"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> authorNickname, hotelId, hotelName </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> author </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">JOIN</span> review <span class="kw">USING</span>(authorId) </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">JOIN</span> hotel <span class="kw">USING</span>(hotelId) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> authorNickname;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>JOIN … ON</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb8"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> authorNickname, hotel.hotelId, hotelName</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> author <span class="kw">JOIN</span> review <span class="kw">JOIN</span> hotel</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span>  hotel.hotelId <span class="op">=</span> review.hotelId</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> review.authorId <span class="op">=</span> author.authorId</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> authorNickname;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="notes" class="level4">
<h4 class="anchored" data-anchor-id="notes">Notes</h4>
<p><strong>NATURAL JOIN</strong></p>
<ul>
<li>Join on “same” column (name and data type)</li>
<li>Risky: the condition is implicit</li>
</ul>
<p><strong>USING()</strong></p>
<ul>
<li>Explicitly specifies columns in the equijoin</li>
<li>Allows multiple (comma separated) columns</li>
</ul>
<p><strong>ON</strong></p>
<ul>
<li>The ON clause enables multiple conditions</li>
<li>Logical operator can be used to combine condition</li>
<li>ON and USING are mutually exclusive</li>
<li>ON enables inequality joins (Theta JOIN – more later)</li>
</ul>
</section>
</section>
<section id="join-variations" class="level3">
<h3 class="anchored" data-anchor-id="join-variations">JOIN Variations</h3>
<p>So far, you’ve learner about <code>INNER JOIN</code>, which is the JOIN that returns only the rows that have matching values in both tables based on a specified condition. It eliminates unmatched rows from both tables, ensuring that only records with a relationship between them appear in the result set.</p>
<p>However, there are different JOINS too. An <strong>OUTER JOIN</strong> is a powerful SQL feature used when you want to retain <em>“dangling tuples”</em>—rows that don’t have a match in the other table. Unlike inner joins, which only return matching records, outer joins ensure that unmatched rows from one or both tables are included in the results. These missing values are padded with <code>NULLs</code> based on the type of outer join used.</p>
<ul>
<li>A <code>LEFT OUTER JOIN</code> returns all rows from the left table, along with matching rows from the right table. If there’s no match, NULLs are used for the right table’s columns.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[ 30, 70 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/left_join.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></p>
</figure>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/table_left.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/table_left.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></a></p>
</figure>
</div>
<p><code>SELECT * FROM t1 LEFT OUTER JOIN t2 USING (id);</code></p>
</div>
</div>
</div>
<ul>
<li>A <code>RIGHT OUTER JOIN</code> does the opposite—it keeps all rows from the right table and includes matching rows from the left table, filling in NULLs when no match is found.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[ 30, 70 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/right_join.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></p>
</figure>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/table_right.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/table_right.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></a></p>
</figure>
</div>
<p><code>SELECT * FROM t1 RIGHT OUTER JOIN t2 USING (id);</code></p>
</div>
</div>
</div>
<ul>
<li>A <code>FULL OUTER JOIN</code> includes all rows from both tables, ensuring that even non-matching rows from either table appear, with NULLs where data is missing.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[ 30, 70 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/full_join.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></p>
</figure>
</div>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/table_full.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></p>
</figure>
</div>
<p><code>SELECT * FROM t1 RIGHT OUTER JOIN t2 USING (id);</code></p>
</div>
</div>
</div>
<p>Outer joins are especially useful for analyzing incomplete data, maintaining records even when relationships are not fully established, and ensuring that no important information is lost in queries.</p>
</section>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise</h3>
<p>Provide a list of all chain names and their respective brands. Order the list by chain name.</p>
<p><strong>Tip:</strong> Keep in mind that not all chains have sub-brands.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb9"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> chainName, brandName</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> lodgingchain <span class="kw">LEFT</span> <span class="kw">OUTER</span> <span class="kw">JOIN</span> brand <span class="kw">USING</span>(chainId)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> chainName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extra-practice-cell" class="level2">
<h2 class="anchored" data-anchor-id="extra-practice-cell">Extra practice cell</h2>
<div class="interactive-sql">
<div class="sourceCode" id="cb10"><pre class="sourceCode sql interactive hr3 code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[ 70, 30 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p>That’s it for this lesson on SQL joins! Understanding how to combine data from multiple tables is a crucial skill for making informed business decisions. Whether you’re analyzing sales trends, tracking customer behavior, or managing inventory, SQL joins help you unlock valuable insights from your data. As you continue learning, you’ll discover even more ways to refine and optimize your queries. Keep practicing, and soon, you’ll be confidently using SQL to drive smarter business strategies! 🚀</p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="images/taken.jpeg" class="img-fluid"></p>
</div>
</div>
</div>
<hr>
<div class="disclaimer">
<p>
<strong>Images and GIFs Disclaimer:</strong> Some of the images and GIFs used on this website are not owned by me. They are used for educational and illustrative purposes only. All rights belong to their respective owners. If you believe any content violates copyright, please contact me for prompt removal.
</p>
</div>
<style>
.disclaimer {
  font-size: 0.8em;
  color: #666;
  border-top: 1px solid #ddd;
  padding-top: 10px;
  margin-top: 20px;
}
</style>
<div>
<!-- Footer Section -->
<div style="
  width: 100vw;
  height: auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #f9f9f9;
  font-size: 12px;
  border-top: 1px solid #ddd;
  box-sizing: border-box;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 10px 20px;
">
  <!-- Left-aligned -->
  <div style="text-align: left; font-size: 16px;">
    © 2025. All Rights Reserved.
  </div>
  

  <!-- Right-aligned -->
  <div style="text-align: right; font-size: 16px;">
    Enabled by Dr. Marcin Bartosiak
  </div>
</div>

<!-- Mobile Responsiveness -->
<style>
  @media screen and (max-width: 768px) {
    div[style*="width: 100vw"] {
      flex-direction: column;
      height: auto;
      padding: 10px 15px;
    }
    
    div[style*="width: 100vw"] > div {
      text-align: center;
      margin-bottom: 5px;
    }
  }
</style>

</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
<sqlime-db name="hr3" path="https://raw.githubusercontent.com/MBPL89/dbs/refs/heads/main/htlreviews3.sql"></sqlime-db>
<sqlime-examples db="hr3" selector="div.interactive-sql pre.hr3 code" editable=""></sqlime-examples>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"openEffect":"zoom","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-contrib/interactive-sql-1.0.0/interactive-sql.js"></script>
</body></html>